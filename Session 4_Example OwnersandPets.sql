

DROP DATABASE IF EXISTS OwnersAndPets;
CREATE DATABASE OwnersAndPets

USE OwnersAndPets
GO

/*first need to create Origins and Owners as they both have a PK*/

/*not a single item can be zero --> NOT NULL*/

DROP TABLE IF EXISTS Origins;
CREATE TABLE Origins
( PetSpeciesID	INT	IDENTITY(1,1)	PRIMARY KEY, 
PetSpecies		NVARCHAR(50)	NOT NULL, 
PetAge          NVARCHAR(50)	NOT NULL,
Origin		NVARCHAR(50)	NOT NULL);

SELECT * from dbo.Origins

/*OwnerName cannot be 0, therefore NOT NULL*/

DROP TABLE IF EXISTS Owners;
CREATE TABLE Owners( OwnerID		INT	IDENTITY(1,1)	PRIMARY KEY, 
OwnerName	NVARCHAR (100) 	NOT NULL);

SELECT * from dbo.Owners

/*we are now referencing both FKs by using REFERENCES*/ 

DROP TABLE IF EXISTS Pets;
CREATE TABLE Pets
( PetID		INT	IDENTITY(1,1)	PRIMARY KEY, 
PetName		NVARCHAR (100) 	NOT NULL, 
OwnerID		INT	FOREIGN KEY REFERENCES Owners(OwnerID), 
PetSpeciesID	INT 	NOT NULL	 FOREIGN KEY REFERENCES Origins(PetSpeciesID), 
PetAge		INT	NOT NULL);

SELECT * from dbo.Pets

ALTER TABLE Origins
DROP CONSTRAINT IF EXISTS CHK_AgeLimit
GO

ALTER TABLE Origins
ADD CONSTRAINT CHK_AgeLimit
CHECK((PetSpecies  = 'Hamster') AND (PetAge < 7) OR 
  	  (PetSpecies != 'Hamster') AND (PetAge < 20)
	 )
GO