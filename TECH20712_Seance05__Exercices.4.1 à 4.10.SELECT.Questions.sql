/*
	Fichier créé par Edouard Labbé

	HEC Montréal, Gestion des bases de données
	Séance 2, Exercices 4.1 à 4.10
*/

/*******************************************************************/
USE ADVENTUREWORKS2019; 
GO


/*Soit la table des ventes, SalesOrderHeader*/


--Exercice 4.1 Sélectionner la colonne TotalDue de la table des ventes.
SELECT TotalDue
FROM Sales.SalesOrderHeader;


--Exercice 4.2 Sélectionner les colonnes SubTotal, TaxAmt, et Freight de la table des ventes.

SELECT SubTotal,TaxAmt,Freight
FROM Sales.SalesOrderHeader;


--Exercice 4.3 Faire la somme des colonnes SubTotal, TaxAmt, et Freight de la table des ventes et renommer la colonne

SELECT SubTotal + TaxAmt + Freight AS TotalVentes
FROM Sales.SalesOrderHeader

--Exercice 4.4 Toujours avec une requête, vérifier que 4.3 = 4.1. Faire ressortir les résultats qui ne satisfont pas cette contrainte. 

SELECT SubTotal + TaxAmt + Freight AS TotalVentes, TotalDue
FROM Sales.SalesOrderHeader
WHERE TotalDue <> TotalDue

/*Soit la table des personnes, Person*/



--Exercice 4.5 Sélectionner le nom et le prénom de toutes les personnes

SELECT *
FROM Person.Person;

SELECT FirstName, LastName
FROM Person.Person;

--Exercice 4.6 Sur une seule colonne, sélectionner le prénom et le nom de toutes les personnes

SELECT FirstName + ' ' + LastName AS NomComplet
FROM Person.Person;


--Exercice 4.7 Sur une seule colonne, sélectionner le titre, le prénom et le nom de toutes les personnes. 
--Quel est le défaut potentiel de cette requête? 

SELECT *
FROM Person.Person;

SELECT Title + '' + FirstName + ' ' + LastName AS NomTitreComplet
FROM Person.Person;

SELECT 
    CASE 
        WHEN Title IS NOT NULL AND Title <> '' THEN Title + ' '
        ELSE ''
    END + FirstName + ' ' + LastName AS NomTitreComplet
FROM Person.Person;

--Exercice 4.8 Sélectionner tous les prénoms distincts

SELECT DISTINCT FirstName
FROM Person.Person;

--Exercice 4.9 Sélectionner tous les prénoms distincts triés en ordre alphabétique

SELECT DISTINCT FirstName
FROM Person.Person
ORDER BY FirstName;


--Exercice 4.10 Sélectionner tous les prénoms distincts triés de Z à A, puis conserver seulement les 5 premières lignes

SELECT DISTINCT TOP 5 FirstName
FROM Person.Person
ORDER BY FirstName DESC;









