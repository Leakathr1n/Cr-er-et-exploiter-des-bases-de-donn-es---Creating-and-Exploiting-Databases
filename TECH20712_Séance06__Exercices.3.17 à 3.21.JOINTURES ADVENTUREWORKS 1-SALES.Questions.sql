/*
	Fichier créé par Edouard Labbé
	Modifié par Ivan Maksymyk automne 2019

	HEC Montréal, Gestion des bases de données

	Séance 3, 3.17 à 3.21 Exercices JOINTURES ADVENTUREWORKS
*/

USE [AdventureWorks2019];
GO

/*

3.17 Faire deux requêtes:
	- Une SELECT de toutes les colonnes et lignes dans la table de commandes (SalesOrderHeader).
	- Une SELECT de toutes les colonnes et lignes dans la table de détails des commandes (SalesOrderDetail). 	
*/

SELECT *
FROM Sales.SalesOrderHeader;

SELECT *
FROM Sales.SalesOrderDetail;

/*

3.18a Quelle est la colonne commune à ces deux tables? */
--SalesOrderID

/*
3.18b 
Dans quelle table se trouve la clé lointaine? 
Quelle est le nom de la colonne qui contient la clé lointaine?
PK: Sales.SalesOrderHeader
FK:Sales.SalesOrder Detail et il s'appelle SalesOrderID 

3.19 Faites un INNER JOIN entre SOH(SalesOrderHeader) et SOD(SalesOrderDetail)
			--Sur quelle colonne doit-on faire la jointure?

*/ 



SELECT * 
FROM Sales.SalesOrderHeader SOH
INNER JOIN Sales.SalesOrderDetail SOD 
ON SOH.SalesOrderID = SOD.SalesOrderID;

/*

3.20 Combien de lignes se trouvent dans les résultats de 3.19? 
Pour savoir, simplement regardez le coin inférieur droit de la fenêtre du Management Studio. 
-- 121317

3.21a 
Exécutez une LEFT JOIN, une RIGHT JOIN, et une FULL JOIN et
pour chaque requête, observez le nombre de lignes dans les résultats. 
Que remarquez-vous?

*/ 

SELECT * 
FROM Sales.SalesOrderHeader SOH
LEFT JOIN Sales.SalesOrderDetail SOD 
ON SOH.SalesOrderID = SOD.SalesOrderID;

--121317 rows 

SELECT * 
FROM Sales.SalesOrderHeader SOH
RIGHT JOIN Sales.SalesOrderDetail SOD 
ON SOH.SalesOrderID = SOD.SalesOrderID;

--121317 rows

SELECT * 
FROM Sales.SalesOrderHeader SOH
INNER JOIN Sales.SalesOrderDetail SOD 
ON SOH.SalesOrderID = SOD.SalesOrderID;

-- 121317

/*
3.21b
Quand le nombre de lignes est le même dans les quatre sortes de jointures, que peut-on conclure?	

En conclusion, lorsque le nombre de lignes est le même dans les trois types de jointures, 
cela signifie que toutes les données de chaque table sont incluses dans le résultat final, 
et il n'y a pas de données manquantes d'un côté ou de l'autre de la jointure. 
Cela peut être interprété comme une correspondance parfaite entre les données des deux tables.

*/
	
