/*
	Fichier créé par Edouard Labbé

	HEC Montréal, Gestion des bases de données

	Séance 3, 3.22 à 3.25 Exercices JOINTURES ADVENTUREWORKS, les produits
*/

USE [AdventureWorks2019]
GO

/*
	SOIT LES PRODUITS 
*/
--3.22 Écrire deux requêtes: 
			--1 sélectionner la table des produits (Product)
			--2 sélectionner la table qui contient les sous-catégories de produits (SubCategory)

SELECT *
FROM Production.Product;

SELECT *
FROM Production.ProductSubcategory;



--3.23 Sur quelle relation se trouve la clé lointaine et quelle est cette FK 
--			qui permet de joindre les deux tables de manière consistante?

		--Réponse : La FK ProductSubcategoryID se trouve dans la table Product ( il y des NULL et on ne l'a pas dans la table de SubCategory)

--3.24 Faire un LEFT JOIN entre Product et ProductSubcategory

SELECT * 
FROM Production.Product
LEFT JOIN Production.ProductSubcategory
ON Product.ProductSubcategoryID = ProductSubcategory.ProductSubcategoryID ;

--solutions:
SELECT * 
FROM Production.Product P
	LEFT JOIN Production.ProductSubcategory PSC ON P.ProductSubcategoryID = PSC.ProductSubcategoryID

-- notes: est-ce qu'il y une difference entre les deux et si, c'est quoi exactement? --

--3.25 
		--a)Inverser l'ordre des tables jointes de la requête précédente
		--b)Y a-t-il une différence? Pourquoi?
		--c)Dans quel ordre doit-on faire la jointure pour consulter les données correctement?
		--d)Écrire une requête équivalente

--a)

SELECT * 
FROM Production.ProductSubcategory PSC 
LEFT JOIN Production.Product P
ON P.ProductSubcategoryID = PSC.ProductSubcategoryID

--b) Oui, il y a une difference entre les deux. Dans la deuxieme, on n'a pas the cellules qui ont un NULL pour la ProductSubcatergoryID. 
-- La raison pour laquelle est qu'on fait in left join et on fussione seulement les lignes qui ont des valeurs pour ProductSubcatergoyID.

--c)
SELECT * 
FROM Production.Product P
LEFT JOIN Production.ProductSubcategory PSC 
ON P.ProductSubcategoryID = PSC.ProductSubcategoryID

--si non, on perd des données

--d) on peut changer les tables et puis on fait on RIGHT JOIN; c'est la meme chose. 

SELECT * 
FROM Production.ProductSubcategory	PSC
RIGHT JOIN Production.Product P 
ON P.ProductSubcategoryID = PSC.ProductSubcategoryID

